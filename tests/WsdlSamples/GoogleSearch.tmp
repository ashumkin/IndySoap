Unit GoogleSearch;

{---------------------------------------------------------------------------
This file generated by the IndySoap WSDL -> Pascal translator

Source:   file://WsdlSamples/GoogleSearch.wsdl
Date:     29/05/2013 11:36:21 AM
IndySoap: V1.00
---------------------------------------------------------------------------}

Interface

Uses
  Classes,
  IdSoapClient,
  IdSoapRpcPacket,
  IdSoapTypeRegistry;

Type

  DirectoryCategory = class;
  GoogleSearchResult = class;
  ResultElement = class;

  DirectoryCategoryArray = array of DirectoryCategory;
  ResultElementArray = array of ResultElement;

  DirectoryCategory = class (TIdBaseSoapableClass)
  Private
    FfullViewableName : String;
    FspecialEncoding : String;
  Published
    property fullViewableName : String read FfullViewableName write FfullViewableName;
    property specialEncoding : String read FspecialEncoding write FspecialEncoding;
  end;

  GoogleSearchResult = class (TIdBaseSoapableClass)
  Private
    FdocumentFiltering : Boolean;
    FsearchComments : String;
    FestimatedTotalResultsCount : Integer;
    FestimateIsExact : Boolean;
    FresultElements : ResultElementArray;
    FsearchQuery : String;
    FstartIndex : Integer;
    FendIndex : Integer;
    FsearchTips : String;
    FdirectoryCategories : DirectoryCategoryArray;
    FsearchTime : Double;
  Public
    destructor Destroy; override;
    property resultElements : ResultElementArray read FresultElements write FresultElements;
    property directoryCategories : DirectoryCategoryArray read FdirectoryCategories write FdirectoryCategories;
  Published
    property documentFiltering : Boolean read FdocumentFiltering write FdocumentFiltering;
    property searchComments : String read FsearchComments write FsearchComments;
    property estimatedTotalResultsCount : Integer read FestimatedTotalResultsCount write FestimatedTotalResultsCount;
    property estimateIsExact : Boolean read FestimateIsExact write FestimateIsExact;
    property searchQuery : String read FsearchQuery write FsearchQuery;
    property startIndex : Integer read FstartIndex write FstartIndex;
    property endIndex : Integer read FendIndex write FendIndex;
    property searchTips : String read FsearchTips write FsearchTips;
    property searchTime : Double read FsearchTime write FsearchTime;
  end;

  ResultElement = class (TIdBaseSoapableClass)
  Private
    Fsummary : String;
    FURL : String;
    Fsnippet : String;
    Ftitle : String;
    FcachedSize : String;
    FrelatedInformationPresent : Boolean;
    FhostName : String;
    FdirectoryCategory : DirectoryCategory;
    FdirectoryTitle : String;
  Published
    property summary : String read Fsummary write Fsummary;
    property URL : String read FURL write FURL;
    property snippet : String read Fsnippet write Fsnippet;
    property title : String read Ftitle write Ftitle;
    property cachedSize : String read FcachedSize write FcachedSize;
    property relatedInformationPresent : Boolean read FrelatedInformationPresent write FrelatedInformationPresent;
    property hostName : String read FhostName write FhostName;
    property directoryCategory : DirectoryCategory read FdirectoryCategory write FdirectoryCategory;
    property directoryTitle : String read FdirectoryTitle write FdirectoryTitle;
  end;


type
  {Soap Address for this Interface: http://api.google.com/search/beta2}
  IGoogleSearch = Interface (IIdSoapInterface) ['{3062FECC-FE17-4FE7-967A-1B80EAA4C73B}']
       {!Namespace: urn:GoogleSearch;
         SoapAction: urn:GoogleSearchAction}
    function  doGetCachedPage(key : String; url : String) : TStream; stdcall;
      {!Request: doGetCachedPage; }
    function  doSpellingSuggestion(key : String; phrase : String) : String; stdcall;
      {!Request: doSpellingSuggestion; }
    function  doGoogleSearch(key : String; q : String; start : Integer; maxResults : Integer; filter : Boolean; restrict : String; safeSearch : Boolean; lr : String; ie : String; oe : String) : GoogleSearchResult; stdcall;
      {!Request: doGoogleSearch; }
  end;

function GetIGoogleSearch(AClient : TIdSoapBaseSender; ASetUrl : Boolean = true) : IGoogleSearch;

Implementation

Uses
  IdSoapRTTIHelpers,
  IdSoapUtilities,
  SysUtils;

{ GoogleSearchResult }

destructor GoogleSearchResult.destroy;
begin
  IdSoapFreeAndNilArray(pointer(FresultElements), TypeInfo(ResultElementArray));
  IdSoapFreeAndNilArray(pointer(FdirectoryCategories), TypeInfo(DirectoryCategoryArray));
  inherited;
end;


function GetIGoogleSearch(AClient : TIdSoapBaseSender; ASetUrl : Boolean = true) : IGoogleSearch;
begin
  if ASetURL and (AClient is TIdSoapWebClient) then
    begin
    (AClient as TIdSoapWebClient).SoapURL := 'http://api.google.com/search/beta2';
    end;
  result := IdSoapD4Interface(AClient) as IGoogleSearch;
end;

Initialization
  IdSoapRegisterType(TypeInfo(DirectoryCategory));
  IdSoapRegisterType(TypeInfo(DirectoryCategoryArray), '', TypeInfo(DirectoryCategory));
  IdSoapRegisterType(TypeInfo(GoogleSearchResult));
  IdSoapRegisterProperty('GoogleSearchResult', 'resultElements',
                   IdSoapFieldProp(@GoogleSearchResult(nil).FresultElements),
                   IdSoapFieldProp(@GoogleSearchResult(nil).FresultElements),
                   TypeInfo(ResultElementArray));
  IdSoapRegisterProperty('GoogleSearchResult', 'directoryCategories',
                   IdSoapFieldProp(@GoogleSearchResult(nil).FdirectoryCategories),
                   IdSoapFieldProp(@GoogleSearchResult(nil).FdirectoryCategories),
                   TypeInfo(DirectoryCategoryArray));
  IdSoapRegisterType(TypeInfo(ResultElement));
  IdSoapRegisterType(TypeInfo(ResultElementArray), '', TypeInfo(ResultElement));
End.
