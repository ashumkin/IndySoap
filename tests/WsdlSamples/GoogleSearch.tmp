Unit GoogleSearch;

{---------------------------------------------------------------------------
This file generated by the IndySoap WSDL -> Pascal translator

Source:   file://WsdlSamples\GoogleSearch.wsdl
Date:     14/08/2013 8:44:18 AM
IndySoap: V2.00-000
---------------------------------------------------------------------------}

Interface

Uses
  Classes,
  IdSoapClient,
  IdSoapRpcPacket,
  IdSoapTypeRegistry;

Type

  DirectoryCategory = class;
  ResultElement = class;
  GoogleSearchResult = class;

  DirectoryCategoryArray = array of DirectoryCategory;
  ResultElementArray = array of ResultElement;

  DirectoryCategory = class (TIdBaseSoapableClass)
  Private
    FfullViewableName : string;
    FspecialEncoding : string;
  Published
    property fullViewableName : string read FfullViewableName write FfullViewableName;
    property specialEncoding : string read FspecialEncoding write FspecialEncoding;
  end;

  ResultElement = class (TIdBaseSoapableClass)
  Private
    Fsummary : string;
    FURL : string;
    Fsnippet : string;
    Ftitle : string;
    FcachedSize : string;
    FrelatedInformationPresent : Boolean;
    FhostName : string;
    FdirectoryCategory : DirectoryCategory;
    FdirectoryTitle : string;
  Published
    property summary : string read Fsummary write Fsummary;
    property URL : string read FURL write FURL;
    property snippet : string read Fsnippet write Fsnippet;
    property title : string read Ftitle write Ftitle;
    property cachedSize : string read FcachedSize write FcachedSize;
    property relatedInformationPresent : Boolean read FrelatedInformationPresent write FrelatedInformationPresent;
    property hostName : string read FhostName write FhostName;
    property directoryCategory : DirectoryCategory read FdirectoryCategory write FdirectoryCategory;
    property directoryTitle : string read FdirectoryTitle write FdirectoryTitle;
  end;

  GoogleSearchResult = class (TIdBaseSoapableClass)
  Private
    FdocumentFiltering : Boolean;
    FsearchComments : string;
    FestimatedTotalResultsCount : Integer;
    FestimateIsExact : Boolean;
    FresultElements : ResultElementArray;
    FsearchQuery : string;
    FstartIndex : Integer;
    FendIndex : Integer;
    FsearchTips : string;
    FdirectoryCategories : DirectoryCategoryArray;
    FsearchTime : Double;
  Public
    destructor Destroy; override;
    property resultElements : ResultElementArray read FresultElements write FresultElements;
    property directoryCategories : DirectoryCategoryArray read FdirectoryCategories write FdirectoryCategories;
  Published
    property documentFiltering : Boolean read FdocumentFiltering write FdocumentFiltering;
    property searchComments : string read FsearchComments write FsearchComments;
    property estimatedTotalResultsCount : Integer read FestimatedTotalResultsCount write FestimatedTotalResultsCount;
    property estimateIsExact : Boolean read FestimateIsExact write FestimateIsExact;
    property searchQuery : string read FsearchQuery write FsearchQuery;
    property startIndex : Integer read FstartIndex write FstartIndex;
    property endIndex : Integer read FendIndex write FendIndex;
    property searchTips : string read FsearchTips write FsearchTips;
    property searchTime : Double read FsearchTime write FsearchTime;
  end;


type
  {Soap Address for this Interface: http://api.google.com/search/beta2}
  IGoogleSearch = Interface (IIdSoapInterface) ['{C162B2BA-6F52-49DD-AE42-4BC97C9616AD}']
       {!Namespace: urn:GoogleSearch;
         SoapAction: urn:GoogleSearchAction}
    function  doGetCachedPage(key : string; url : string) : TStream; stdcall;
      {!Request: doGetCachedPage; }
    function  doSpellingSuggestion(key : string; phrase : string) : string; stdcall;
      {!Request: doSpellingSuggestion; }
    function  doGoogleSearch(key : string; q : string; start : Integer; maxResults : Integer; filter : Boolean; restrict : string; safeSearch : Boolean; lr : string; ie : string; oe : string) : GoogleSearchResult; stdcall;
      {!Request: doGoogleSearch; }
  end;

function GetIGoogleSearch(AClient : TIdSoapBaseSender; ASetUrl : Boolean = true) : IGoogleSearch;

Implementation

Uses
  IdSoapRTTIHelpers,
  IdSoapUtilities,
  SysUtils;

{ GoogleSearchResult }

destructor GoogleSearchResult.destroy;
begin
  IdSoapFreeAndNilArray(pointer(FresultElements), TypeInfo(ResultElementArray));
  IdSoapFreeAndNilArray(pointer(FdirectoryCategories), TypeInfo(DirectoryCategoryArray));
  inherited;
end;


function GetIGoogleSearch(AClient : TIdSoapBaseSender; ASetUrl : Boolean = true) : IGoogleSearch;
begin
  if ASetURL and (AClient is TIdSoapWebClient) then
    begin
    (AClient as TIdSoapWebClient).SoapURL := 'http://api.google.com/search/beta2';
    end;
  result := IdSoapD4Interface(AClient) as IGoogleSearch;
end;

Initialization
  IdSoapRegisterType(TypeInfo(DirectoryCategoryArray), '', TypeInfo(DirectoryCategory));
  IdSoapRegisterType(TypeInfo(DirectoryCategory));
  IdSoapRegisterType(TypeInfo(ResultElement));
  IdSoapRegisterType(TypeInfo(ResultElementArray), '', TypeInfo(ResultElement));
  IdSoapRegisterType(TypeInfo(GoogleSearchResult));
  IdSoapRegisterProperty('GoogleSearchResult', 'resultElements',
                   IdSoapFieldProp(@GoogleSearchResult(nil).FresultElements),
                   IdSoapFieldProp(@GoogleSearchResult(nil).FresultElements),
                   TypeInfo(ResultElementArray));
  IdSoapRegisterProperty('GoogleSearchResult', 'directoryCategories',
                   IdSoapFieldProp(@GoogleSearchResult(nil).FdirectoryCategories),
                   IdSoapFieldProp(@GoogleSearchResult(nil).FdirectoryCategories),
                   TypeInfo(DirectoryCategoryArray));
End.
